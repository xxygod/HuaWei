ec.pkg("ec.member.orderList");ec.load("ajax");ec.load("ec.box",{loadType:"lazy"});ec.load("jquery.movebar");ec.member.orderList.openAddRemarkView=function(a){$.ajax({url:"/member/addUserRemarkView?orderCode="+a+"&t="+new Date().getTime(),dataType:"jsonp",success:function(c){var d=$(c);if(d.length==1&&d.hasClass("errorMsg")){var b=encodeURIComponent(d.text());window.location.href="/member/prdRemark/errorMsg?msg="+b}else{$("div.u-4-5").html(c);ec.member.add.showView()}}})};ec.member.orderList.getUserOrderRemarkStatus=function(c){if($("#colid").val()=="0"||c=="0"){return}var a="";var b=true;$(".button-operate-revie").each(function(){if(b){a=$(this).attr("orderInfo");b=false}else{a+=","+$(this).attr("orderInfo")}});if(a!=""){$.ajax({url:openApiDomain+"/rms/comment/getOrderCommentStatus.json?t="+new Date().getTime(),type:"POST",dataType:"json",data:JSON.stringify({orderCode:a}),timeout:10000,beforeSend:function(d){d.withCredentials=true},success:function(d){$(".button-operate-revie").each(function(){var g;var f=$(this).attr("orderInfo");if(d.data&&d.data!=undefined){for(var e=0;e<d.data.length;e++){g=d.data[e];if((f==g.orderCode)&&(g.status==1)){$(this).attr("href","javascript:ec.member.orderList.commentsRealName("+g.orderCode+")");$(this).attr("title","\u6211\u8981\u8bc4\u8bba");$(this).attr("innerHTML","<span>\u6211\u8981\u8bc4\u8bba</span>");$(this).parent(".p-button").removeClass("hide")}}}})}})}};ec.member.orderList.commentsRealName=function(a){new ec.ajax().get({url:domainMain+"/member/addUserRemarkView.json?t="+new Date().getTime(),dataType:"json",data:{orderCode:a},timeout:10000,timeoutFunction:function(){alert("\u8bfb\u53d6\u8d85\u65f6\uff0c\u8bf7\u91cd\u8bd5\uff01")},successFunction:function(b){if(b.success){window.location.href="/member/addUserRemarkView?orderCode="+a}else{ec.account.syncCustomSession(function(c){if(c==null||c.customerInfo.userState==null){window.location.href="/member/addUserRemarkView?orderCode="+a;return}else{ec.member.orderList.vildateComments(a)}})}}})};ec.member.orderList.vildateComments=function(a){new ec.ajax().get({url:domainMain+"/member/addUserRemarkView.json?t="+new Date().getTime(),dataType:"json",data:{orderCode:a},timeout:10000,timeoutFunction:function(){alert("\u8bfb\u53d6\u8d85\u65f6\uff0c\u8bf7\u91cd\u8bd5\uff01")},successFunction:function(b){if(b.success){window.location.href="/member/addUserRemarkView?orderCode="+a}else{ec.member.orderList.commentsTip()}}})};ec.member.orderList.remindBox=function(b,a){new ec.box(b,{boxclass:"ol_box_4 small",title:"",width:"",showButton:false,autoHeight:false,onok:function(c){$.ajax({type:"POST",url:"/member/order/remind.json",data:{orderCode:a},dataType:"json",timeout:2000,success:function(d){}});c.close()}}).open()};ec.member.orderList.commentsTip=function(){new ec.box($("#realNameComment").val(),{boxclass:"ol_box_4",title:"",width:540,showButton:false,autoHeight:false,onok:function(){}}).open()};ec.member.orderList.unpayTip=function(){new ec.box($("#unPay-inOnce").val(),{boxclass:"ol_box_4 small",title:"",showButton:false,autoHeight:false,onok:function(){}}).open()};ec.ready(function(){ec.account.dapPushMsg("","","view");$("#ec_ui_confirm").click(function(b){b=b||window.event;b.stopPropagation()});$(document).bind("click",function(c){var c=c||window.event;var b=c.target||c.srcElement;if(b.innerHTML!="\u53d6\u6d88\u8ba2\u5355"&&b.innerHTML!="\u5220\u9664\u8ba2\u5355"){$("#ec_ui_confirm").hide()}});$("#li-order").addClass("current");$("#pathTitle").html("\u6211\u7684\u8ba2\u5355");ec.member.orderList.interfaceTpl=new ec.template($("#interface-tpl").val());window.onhashchange=function(){var b=window.location.hash;if(b&&b.length>0){b=b.substring(1,b.length);if(b.length>0){ec.member.orderList.openAddRemarkView(b)}else{window.location.reload()}}else{window.location.reload()}};var a=window.location.hash;if(a&&a.length>0){a=a.substring(1,a.length);if(a.length>0){ec.member.orderList.openAddRemarkView(a);return}}ec.member.orderList.getUserOrderRemarkStatus();if($(".list-group-item").length<1){$("#order-merge-pay").hide()}});ec.member.orderList.load=function(d){var b,a,c,e;if($("#checkid").val()=="nocomment"){b=openApiDomain+"/rms/comment/getNoCommentOrders.json?t="+new Date().getTime();a="json";c=0;e=JSON.stringify({pageNum:d.pageNumber,pageSize:5})}else{b=domainMain+"/member/order.json?t="+new Date().getTime();a="json";c=1;e={dateType:$("#colid").val(),tab:$("#checkid").val(),pageNumber:d.pageNumber,pageSize:5}}$.ajax({url:b,dataType:a,data:e,type:"POST",timeout:10000,timeoutFunction:function(){alert("\u8bfb\u53d6\u8d85\u65f6\uff0c\u8bf7\u91cd\u8bd5\uff01")},beforeSend:function(f){ec.ui.loading.show({modal:false});f.withCredentials=true},success:function(f){ec.ui.loading.hide();if(0==c){if(f.resultCode!=0){if(f.resultCode=="42003"){ec.account.loginName="";ec.account.afterLogin(function(){ec.member.orderList.load(d)})}else{alert("\u5f88\u62b1\u6b49\uff01\u8ba2\u5355\u5217\u8868\u67e5\u8be2\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u65b0\u64cd\u4f5c")}return}}else{if(!f.success){if(f.code=="login"){ec.account.loginName="";ec.account.afterLogin(function(){ec.member.orderList.load(d)})}else{alert("\u5f88\u62b1\u6b49\uff01\u8ba2\u5355\u5217\u8868\u67e5\u8be2\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u65b0\u64cd\u4f5c")}return}}ec.member.orderList.push(f,c);if(f.orderList&&f.orderList.length>0){if($("input[name='payCheck']").length==0||$("input[name='payCheck']").length==1){$("#myOrder-control-bottom").hide();$("#myOrder-control-bottom-up").hide()}else{$("#checkAllBox").attr("checked",false);$("#bottomCheckAllBox").attr("checked",false);$("#myOrder-control-bottom").show();$("#myOrder-control-bottom-up").show()}}else{$("#myOrder-control-bottom").hide();$("#myOrder-control-bottom-up").hide()}}})};ec.member.orderList.push=function(v,r){var h=[],m,u,d,g,o=$("#colid").val(),l="",w="",b="";if(0==r){d=v.data.orderList;g=v.data.page}else{d=v.orderList;g=v.page}if(d&&d.length>0){for(var t=0;t<d.length;t++){var e;m=d[t];u=(o==0&&m.isHisData==0)?"0":"1",b=(m.paymentStatus==1)?"\u5df2\u4ed8\u6b3e":"\u5f85\u652f\u4ed8";if(m.orderClearing!=null){e="true"}else{e="false"}if(m.orderStatus=="4"||m.orderStatus=="8"){l=(new Date(m.orderDate)).format("yyyy-MM-dd")+"&nbsp;&nbsp;"+(new Date(m.orderDate)).format("HH:mm");w=b}else{if(m.orderStatus=="7"){l=(new Date(m.orderDate)).format("yyyy-MM-dd")+"&nbsp;&nbsp;"+(new Date(m.orderDate)).format("HH:mm");w=ec.encodeForHTML(m.orderStatusText)+"&nbsp;|&nbsp;"+ec.encodeForHTML(b)}else{l=(new Date(m.orderDate)).format("yyyy-MM-dd")+"&nbsp;&nbsp;"+(new Date(m.orderDate)).format("HH:mm");w=(m.orderStatus=="6")?b:(ec.encodeForHTML(m.orderStatusText)+"&nbsp;|&nbsp;"+ec.encodeForHTML(b))}}h.push('<div class="list-group-item"><div class="o-info">');if(m.orderStatus==8){h.push('<div class="col-info">');var a=m.type!=18&&(m.paymentStatus==2||m.paymentStatus==3)&&(m.orderStatus==3||(m.orderStatus<3&&m.orderSource!=2));if(a){h.push('<input type="checkbox" class="checkbox" name="payCheck" paymentStatus="'+m.paymentStatus+'"clearOrder="'+e+'" value="'+m.orderCode+'"/>')}if(m.type==22){h.push('<span class="o-icon">\u5956\u54c1</span>')}h.push('<span class="o-date">'+l+'</span><span class="o-no">\u8ba2\u5355\u53f7\uff1a');h.push('<a href="/member/order-'+m.orderCode+"?isHisData="+u+'" title="'+m.orderCode+'">'+m.orderCode+"</a></span>");if(m.type==33){h.push('<span class="o-icon-1">\u62fc\u8d2d</span>')}if(m.type==26){h.push('<span class="icon-priority"></span>')}h.push('</div><div class="col-state">');if(m.paymentStatus==1){h.push("\u5df2\u53d6\u6d88&nbsp;|&nbsp;\u5df2\u4ed8\u6b3e")}else{if(m.paymentStatus==2){h.push("\u5df2\u53d6\u6d88")}else{if(m.paymentStatus==3){if(m.type==18){h.push("\u5df2\u652f\u4ed8\u8ba2\u91d1")}else{h.push("\u5df2\u90e8\u5206\u4ed8\u6b3e")}}else{h.push("\u5f85\u652f\u4ed8")}}}h.push("</div>")}else{if(m.orderStatus==12){h.push('<div class="col-info">');var a=m.type!=18&&(m.paymentStatus==2||m.paymentStatus==3)&&(m.orderStatus==3||(m.orderStatus<3&&m.orderSource!=2));if(a){h.push('<input type="checkbox" class="checkbox" name="payCheck" paymentStatus="'+m.paymentStatus+'"clearOrder="'+e+'" value="'+m.orderCode+'"/>')}if(m.type==22){h.push('<span class="o-icon">\u5956\u54c1</span>')}h.push('<span class="o-date">'+l+'</span><span class="o-no">\u8ba2\u5355\u53f7\uff1a');h.push('<a href="/member/order-'+m.orderCode+"?isHisData="+u+'" title="'+m.orderCode+'">'+m.orderCode+"</a></span>");if(m.type==33){h.push('<span class="o-icon-1">\u62fc\u8d2d</span>')}if(m.type==26){h.push('<span class="icon-priority"></span>')}h.push('</div><div class="col-state">');if(m.paymentStatus==2){h.push("\u5173\u95ed\u652f\u4ed8&nbsp;|&nbsp;\u672a\u652f\u4ed8")}else{if(m.paymentStatus==1){h.push("\u5173\u95ed\u652f\u4ed8&nbsp;|&nbsp;\u5df2\u652f\u4ed8")}else{h.push("\u5173\u95ed\u652f\u4ed8&nbsp;|&nbsp;\u5f85\u652f\u4ed8")}}h.push("</div>")}else{if(m.orderStatus==7){h.push('<div class="col-info">');var a=m.type!=18&&(m.paymentStatus==2||m.paymentStatus==3)&&(m.orderStatus==3||(m.orderStatus<3&&m.orderSource!=2));if(a){h.push('<input type="checkbox" class="checkbox" name="payCheck" paymentStatus="'+m.paymentStatus+'"clearOrder="'+e+'" value="'+m.orderCode+'"/>')}if(m.type==22){h.push('<span class="o-icon">\u5956\u54c1</span>')}h.push('<span class="o-date">'+l+'</span><span class="o-no">\u8ba2\u5355\u53f7\uff1a');h.push('<a href="/member/order-'+m.orderCode+"?isHisData="+u+'" title="'+m.orderCode+'">'+m.orderCode+"</a></span>");if(m.type==33){h.push('<span class="o-icon-1">\u62fc\u8d2d</span>')}if(m.type==26){h.push('<span class="icon-priority"></span>')}if(m.type==28||m.type==36){}else{h.push('<span class="o-logistics">');h.push('<a href="javascript:;" onmouseover="ec.member.orderList.openLog(this, '+m.orderCode+')">\u7269\u6d41\u4fe1\u606f</a>');h.push('<div class="o-logistics-record" id="interface-dialog-'+m.orderCode+'">');h.push('<div class="o-logistics-list" id="interface-msg-'+m.orderCode+'">');h.push('<div class="o-logistics-list-loading">\u52a0\u8f7d\u4e2d</div></div><s></s></div></span>')}h.push('</div><div class="col-state">'+ec.encodeForHTML(m.orderStatusText)+"&nbsp;|&nbsp;");if(m.paymentStatus==1){h.push("\u5df2\u4ed8\u6b3e")}else{if(m.paymentStatus==2){h.push("\u5df2\u53d6\u6d88")}else{h.push("\u5f85\u652f\u4ed8")}}h.push("</div>")}else{h.push('<div class="col-info">');var a=m.type!=18&&(m.paymentStatus==2||m.paymentStatus==3)&&(m.orderStatus==3||(m.orderStatus<3&&m.orderSource!=2));if(a){h.push('<input type="checkbox" class="checkbox" name="payCheck" paymentStatus="'+m.paymentStatus+'"clearOrder="'+e+'" value="'+m.orderCode+'"/>')}if(m.type==22){h.push('<span class="o-icon">\u5956\u54c1</span>')}h.push('<span class="o-date">'+l+'</span><span class="o-no">\u8ba2\u5355\u53f7\uff1a');h.push('<a href="/member/order-'+m.orderCode+"?isHisData="+u+'" title="'+m.orderCode+'">'+m.orderCode+"</a></span>");if(m.type==33){h.push('<span class="o-icon-1">\u62fc\u8d2d</span>')}if(m.type==26){h.push('<span class="icon-priority"></span>')}if(m.orderStatus==6){if(m.type==28||m.type==36){}else{h.push('<span class="o-logistics">');h.push('<a href="javascript:;" onmouseover="ec.member.orderList.openLog(this, '+m.orderCode+')">\u7269\u6d41\u4fe1\u606f</a>');h.push('<div class="o-logistics-record" id="interface-dialog-'+m.orderCode+'">');h.push('<div class="o-logistics-list" id="interface-msg-'+m.orderCode+'">');h.push('<div class="o-logistics-list-loading">\u52a0\u8f7d\u4e2d</div></div><s></s></div></span>')}}h.push('</div><div class="col-state">');if(m.orderStatus==4){h.push("\u5ba1\u6838\u672a\u901a\u8fc7&nbsp;|&nbsp;")}else{if(m.orderStatus==12){h.push("\u5173\u95ed\u652f\u4ed8&nbsp;|&nbsp;")}else{if(m.orderStatus==3){h.push("\u5ba1\u6838\u901a\u8fc7&nbsp;|&nbsp;")}else{if(m.orderStatus==9){h.push("\u6b63\u5728\u51fa\u5e93&nbsp;|&nbsp;")}else{if(m.orderStatus==5){h.push("\u5df2\u51fa\u5e93&nbsp;|&nbsp;")}else{if(m.orderStatus==6||m.orderStatus==15){h.push("\u5df2\u53d1\u8d27&nbsp;|&nbsp;")}else{if(m.orderStatus==7){h.push("\u5df2\u5b8c\u6210&nbsp;|&nbsp;")}else{if(m.orderStatus==14){h.push("\u5df2\u62d2\u6536&nbsp;|&nbsp;")}else{if(m.orderStatus==16){h.push("\u53d6\u6d88\u5904\u7406\u4e2d&nbsp;|&nbsp;")}else{if(m.orderStatus==17){h.push("\u4fee\u6539\u5904\u7406\u4e2d&nbsp;|&nbsp;")}else{h.push(ec.encodeForHTML(m.orderStatusText)+"&nbsp;|&nbsp;")}}}}}}}}}}if(m.paymentStatus==1){h.push("\u5df2\u4ed8\u6b3e")}else{if(m.paymentStatus==3){h.push("\u5df2\u90e8\u5206\u4ed8\u6b3e")}else{h.push("\u5f85\u652f\u4ed8")}}h.push("</div>")}}}h.push('</div><div class="o-pro"><table border="0" cellpadding="0" cellspacing="0"><tbody>');h.push(ec.member.orderList.productList(m));h.push("</tbody></table></div>");if(m.type==18){h.push(ec.member.orderList.depositList(m))}h.push("</div>")}$("#list-group").html(h.join(""));if($("#checkid").val()=="nocomment"){var c=[];for(var t=0;t<d.length;t++){for(var s=0;s<d[t].productList.length;s++){c.push(d[t].productList[s].skuCode);for(var q=0;q<d[t].productList[s].giftList.length;q++){c.push(d[t].productList[s].giftList[q].giftSkuCode)}}}var n=c.length;if(n<=50){ec.member.orderList.loadImg(c)}else{var f=Math.ceil(n/50);for(var t=0;t<f;t++){var s=t*50;if((t+1)==f){ec.member.orderList.loadImg(c.slice(s,n))}else{ec.member.orderList.loadImg(c.slice(s,s+50))}}}$(".button-operate-revie").each(function(){var x;var k=$(this).attr("orderInfo");if(d&&d.length>0){for(var j=0;j<d.length;j++){x=d[j];if(k==x.orderCode){$(this).attr("href","javascript:ec.member.orderList.commentsRealName("+x.orderCode+")");$(this).attr("title","\u6211\u8981\u8bc4\u8bba");$(this).attr("innerHTML","<span>\u6211\u8981\u8bc4\u8bba</span>");$(this).parent(".p-button").removeClass("hide")}}}});ec.member.orderList.renderPage(g)}else{ec.member.orderList.renderPage(g);ec.ui.scrollTo("#myOrder-cate");ec.member.orderList.getUserOrderRemarkStatus(u);ec.member.orderList.payClick()}}else{ec.member.orderList.bottomCheckBoxDisplay(false);$("#list-group").html('<div class="list-group-empty">\u60a8\u6682\u65f6\u6ca1\u6709\u76f8\u5173\u8bb0\u5f55\u3002</div>');$("#list-pager").html("");ec.member.orderList.getUserOrderRemarkStatus(u);ec.member.orderList.payClick()}};ec.member.orderList.loadImg=function(a){new ec.ajax().get({url:pmsHttpDomain+"product/querySbomInfoByCode.json?t="+new Date().getTime()+"&sbomCode="+a.join("&sbomCode="),async:false,dataType:"jsonp",timeout:10000,timeoutFunction:function(){alert("\u8bfb\u53d6\u8d85\u65f6\uff0c\u8bf7\u91cd\u8bd5\uff01")},successFunction:function(c){if(!c.success){alert("\u5f88\u62b1\u6b49\uff01\u5546\u54c1\u56fe\u7247\u67e5\u8be2\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u65b0\u64cd\u4f5c");return}for(var b=0;b<c.data.length;b++){$(".nocomment-"+c.data[b].sbomCode).attr("src",ec.mediaPath+"/"+c.data[b].photoPath+"100_100_"+c.data[b].photoName).attr("alt",c.data[b].name);$(".nocomment-"+c.data[b].sbomCode).parent("a").attr("href","/product/"+c.data[b].prdId+".html#"+c.data[b].sbomId);$(".nocomment-"+c.data[b].sbomCode).attr("href","/product/"+c.data[b].prdId+".html#"+c.data[b].sbomId);if($(".pl-"+c.data[b].sbomCode).html()){$(".pl-"+c.data[b].sbomCode).attr("orderinfo",$(".pl-"+c.data[b].sbomCode).attr("orderinfo").replace("${proId}",c.data[b].prdId))}}ec.member.orderList.bottomCheckBoxDisplay(true);ec.ui.scrollTo("#myOrder-cate");ec.member.orderList.payClick()}})};ec.member.orderList.bottomCheckBoxDisplay=function(a){if(a&&$("#checkid").val()!="nocomment"){$("#myOrder-control-bottom").show();$("#bottomCheckAllBox").attr("checked",false)}else{$("#myOrder-control-bottom").hide()}};ec.member.orderList.productList=function(o){var r=[],t,D,g=0,l=0,s=0,n,f,u,d,a="\u7acb\u5373\u652f\u4ed8",A=["\u652f\u4ed8\u5b9d","\u7f51\u94f6\u652f\u4ed8","\u8d27\u5230\u4ed8\u6b3e","\u9000\u6362\u8d27","\u5feb\u6377\u652f\u4ed8","\u7ebf\u4e0b\u652f\u4ed8","\u8d22\u4ed8\u901a","\u534e\u4e3a\u652f\u4ed8","\u7ebf\u4e0b\u652f\u4ed8","\u94f6\u8054\u5728\u7ebf\u652f\u4ed8"],y=$("#colid").val(),C=(y==0&&o.isHisData==0)?"0":"1",n=o.paymentList||[];if(n.length>0){u="66";d="BALANCE";for(var B=0;B<n.length;B++){if(n[B].paymentMethod!="BALANCE"&&n[B].paymentType!="66"){u=n[B].paymentType;d=n[B].paymentMethod}}}_showPaymentText=function(i,b){i=parseInt(i,10);if(!i||i<1||!b){return""}if(b=="BALANCE"&&i=="66"){return"\u4ee3\u91d1\u5238\u652f\u4ed8"}if(i==17){return"\u5fae\u4fe1\u652f\u4ed8"}if(i==1&&b=="HB"){return"\u82b1\u5457\u652f\u4ed8"}if(i==17||i==67){return"\u5fae\u4fe1\u652f\u4ed8"}if(i==82&&b=="CMBLIFE_CMBLIFE"){return"\u638c\u4e0a\u751f\u6d3b"}if(i==82&&b=="ICBC_ICBC"){return"\u5de5\u884c\u4fe1\u7528\u5361\u652f\u4ed8"}if(i==82&&b=="ABC_ABC"){return"\u519c\u884c\u4fe1\u7528\u5361\u652f\u4ed8"}if(i==82&&b=="BOC_BOC"){return"\u4e2d\u884c\u4fe1\u7528\u5361\u652f\u4ed8"}if(i==84){return"\u7f51\u94f6\u652f\u4ed8"}if(i==86||i==87){return"\u5feb\u6377\u652f\u4ed8"}if(i==83&&b=="UNIONPAY_UNIONPAY"){return"\u94f6\u8054\u5728\u7ebf\u652f\u4ed8"}if(i==83&&b=="HUAWEIPAY_HUAWEIPAY"){return"\u94f6\u8054\u4e91\u95ea\u4ed8\uff08Huawei Pay\uff09"}if(i-1>9){return"\u5728\u7ebf\u652f\u4ed8"}return A[i-1]};if($("#checkid").val()!="nocomment"){f=o.productInfoList||[]}else{f=o.productList||[]}isRefund=o.isRefund;if(o.paymentStatus==3){a="\u652f\u4ed8\u4f59\u6b3e"}var E=0;E+=f.length;for(var B=0;B<f.length;B++){var e=f[B];if(e.subOrderProductInfoList!=undefined&&e.subOrderProductInfoList.length>0){E+=e.subOrderProductInfoList.length}if(e.productCouponList!=undefined){E+=e.productCouponList.length}if(o.couponList!=undefined){E+=o.couponList.length}r.push('<tr><td class="col-pro-img"><p class="p-img">');r.push('<a title="'+e.skuName+'" href="/product/'+e.productId+".html#"+e.skuId+'" target="_blank" onclick="pushProMsg('+e.skuId+",'300130101')\">");if(e.photoPath){r.push('<img class="nocomment-'+e.skuCode+'" alt="'+e.skuName+'" src="'+ec.mediaPath+e.photoPath+"100_100_"+ec.encodeForHTML(e.photoName)+'"/>')}else{r.push('<img class="nocomment-'+e.skuCode+'" alt="" src=""/>')}r.push('</a></p></td><td class="col-pro-info"><p class="p-name">');if(e.itemType=="B"||e.productTypeInfo=="P"){r.push("<b>\u5957\u9910\u5546\u54c1</b>")}r.push('<a title="'+e.skuName+'" target="_blank" ');r.push('class="nocomment-'+e.skuCode+'"href="/product/'+e.productId+".html#"+e.skuId+'" onclick="pushProMsg('+e.skuId+",'300130101')\">"+e.skuName+"</a>");r.push('</p></td><td class="col-price">');if(o.type==18&&e.productType==4&&o.balanceAmount==null){r.push("<span>");r.push("\u6682\u65e0\u62a5\u4ef7")}else{r.push("<em>&yen;</em><span>");r.push((e.unitPrice||0).toFixed(2))}r.push('</span></td><td class="col-quty">');r.push(e.quantity+"</td>");if(B==0){r.push('<td rowspan="'+E+'" class="col-pay">');r.push("<p><em>&yen;</em><span>");if(o.type==18){r.push(o.paymentAmountTotal.toFixed(2)+"</span></p>")}else{r.push(o.paymentAmount.toFixed(2)+"</span></p>")}if(n.length>0){r.push("<p><em>"+_showPaymentText(u,d)+"</em></p>")}r.push("</td>")}if(B==0&&(o.orderStatus<5||o.orderStatus>7)){r.push('<td rowspan="'+E+'" class="col-operate">');if((o.orderStatus==3&&o.paymentStatus==1)||o.orderStatus==9){if(o.type==0||o.type==5||o.type==17||o.type==18){r.push('<p class="p-link"><a href="javascript:;" onclick=\'ec.member.orderList.remind("'+o.orderCode+'","'+o.orderStatus+'","'+o.logisticsName+'","'+o.logisticsNumbers+'","'+o.shippingDate+"\");'>\u6211\u8981\u50ac\u5355</a></p>")}}if(o.orderStatus==8||o.orderStatus==16||o.orderStatus==17){}else{if(o.orderStatus==4){if(o.type==19&&o.orderStatus!=14&&o.orderStatus!=11){r.push('<p class="p-link"><a href="/member/updateToOrder-'+o.orderCode+'">\u4fee\u6539\u8ba2\u5355</a></p>');r.push('<p class="p-link"><a href="javascript:;" data-ordercode="'+o.orderCode+'" onclick="ec.member.orderList.cancel(this, '+o.paymentStatus+","+o.type+');">\u53d6\u6d88\u8ba2\u5355</a></p>')}}else{if(o.orderStatus==12){}else{if(o.type&&o.type==3){}else{if(y==0||o.isHisData!=1){if(o.payFlag&&o.payFlag==1){if(o.type==18){var c=(o.paymentStatus==2||o.paymentAmountTotal<o.depositAmount)&&2!=o.isBalancePayStart;if(c){r.push('<p class="p-button"><a class="button-operate-pay" href="/payment/order-'+o.orderCode+'"><span>\u652f\u4ed8\u8ba2\u91d1</span></a></p>')}else{if(o.paymentStatus==3&&o.isBalancePayStart==0){if(0!=o.cashPay){r.push('<p class="p-button"><a class="button-operate-pay" href="/payment/order-'+o.orderCode+'"><span>\u652f\u4ed8\u5c3e\u6b3e</span></a></p>')}else{r.push('<p class="p-button"><a class="button-operate-pay-disabled" href="javascript:;"><span>\u7b49\u5f85\u5c3e\u6b3e\u786e\u5b9a</span></a></p>')}}else{if((o.paymentStatus==3&&o.isBalancePayStart==1)||o.isBalancePayStart==4){r.push('<p class="p-button"><a class="button-operate-pay-disabled" href="javascript:;"><span>\u7b49\u5f85\u652f\u4ed8\u5c3e\u6b3e</span></a></p>')}else{if((o.paymentStatus==2||o.paymentStatus==3)&&o.isBalancePayStart==2){r.push('<p class="p-button"><a class="button-operate-pay-disabled" href="javascript:;"><span>\u652f\u4ed8\u65f6\u95f4\u5df2\u8fc7</span></a></p>')}}}}}else{r.push('<p class="p-button"><a class="button-operate-pay" href="/payment/order-'+o.orderCode+'"><span>');r.push(a);r.push("</span></a></p>")}}if(o.type!=14&&o.type!=28){if(o.type!=5&&o.orderStatus!=14){if(o.orderStatus!=9&&o.orderStatus!=11){if(o.type==36&&o.paymentStatus==1){}else{r.push('<p class="p-link"><a href="/member/updateToOrder-'+o.orderCode+'">\u4fee\u6539\u8ba2\u5355</a></p>')}}}if((o.type!=3&&o.type!=17&&o.orderStatus!=14)||(o.orderStatus==9)){if((o.type==9||o.type==25||o.type==19)&&o.orderStatus==9){}else{if(o.orderStatus!=11){if(o.paymentStatus==1&&o.orderStatus==1&&o.type==33){}else{if(o.paymentStatus==1&&o.type==35){}else{r.push('<p class="p-link"><a href="javascript:;" data-ordercode="'+o.orderCode+'" onclick="ec.member.orderList.cancel(this, '+o.paymentStatus+","+o.type+');">\u53d6\u6d88\u8ba2\u5355</a></p>')}}}}}}else{if(o.type==28){if(o.orderStatus<7){r.push('<p class="p-link"><a href="javascript:;" data-ordercode="'+o.orderCode+'" onclick="ec.member.orderList.cancel(this, '+o.paymentStatus+","+o.type+');">\u53d6\u6d88\u8ba2\u5355</a></p>')}}else{if(o.orderStatus<7){r.push('<p class="p-link"><a href="/member/updateToOrder-'+o.orderCode+'">\u4fee\u6539\u8ba2\u5355</a></p>');if(o.paymentStatus==2&&o.orderStatus!=11){r.push('<p class="p-link"><a href="javascript:;" data-ordercode="'+o.orderCode+'" onclick="ec.member.orderList.cancel(this, '+o.paymentStatus+","+o.type+');">\u53d6\u6d88\u8ba2\u5355</a></p>')}}}}}}}}}if((o.orderStatus==8&&o.canceledOrderDelPermission)||(o.orderStatus==7&&(o.timeDifference>=16||ec.member.orderList.GetDateDiff(o.updateDate)>=16))){r.push('<p class="p-link"><a href="javascript:;" onclick="ec.member.orderList.del(this,\''+o.orderCode+"');\">\u5220\u9664\u8ba2\u5355</a></p>")}r.push('<p class="p-link"><a href="/member/order-'+o.orderCode+"?isHisData="+C+'">\u8ba2\u5355\u8be6\u60c5</a></p>');if(o.isRefund==1){r.push('<p class="p-link"><a href="/member/refund?ordercode='+o.orderCode+"&isLive="+C+'">\u9000\u6b3e\u8be6\u60c5</a></p>')}r.push("</td>")}if(o.orderStatus>=5&&o.orderStatus<=7){if(B==0){r.push('<td rowspan="'+E+'" class="col-operate">');if(o.orderStatus==5||o.orderStatus==6){if(o.type==0||o.type==5||o.type==17||o.type==18){r.push('<p class="p-link"><a href="javascript:;" onclick=\'ec.member.orderList.remind("'+o.orderCode+'","'+o.orderStatus+'","'+o.logisticsName+'","'+o.logisticsNumbers+'","'+o.shippingDate+"\")';>\u6211\u8981\u50ac\u5355</a></p>")}}if(o.shopCode=="VMALL-HUAWEIDEVICE"&&o.orderStatus==6){}if(!e.remarkId&&o.orderStatus==7){if(e.productId){r.push('<p class="p-button hide"><a class="button-operate-revie pl-'+e.skuCode+'" href="javascript:;" orderInfo="'+o.orderCode+'"><span>\u6211\u8981\u8bc4\u8bba</span></a></p>')}else{r.push('<p class="p-button hide"><a class="button-operate-revie pl-'+e.skuCode+'" href="javascript:;" orderInfo="'+o.orderCode+'"><span>\u6211\u8981\u8bc4\u8bba</span></a></p>')}}var c=e.productType!=2&&o.type!=12&&o.type!=14&&o.type!=28&&o.type!=36&&o.type!=3&&o.type!=9&&o.type!=19&&o.orderStatus==7;if(y==0){if(o.orderStatus==7&&(o.timeDifference>=16||ec.member.orderList.GetDateDiff(o.updateDate)>=16)){r.push('<p class="p-link"><a href="javascript:;" onclick="ec.member.orderList.del(this,\''+o.orderCode+"');\">\u5220\u9664\u8ba2\u5355</a></p>")}else{if(c){if(o.type==35&&o.paymentStatus==1){}else{r.push('<p class="p-link"><a href="javascript:;" data-href="/member/exchange/get-'+o.orderCode+'" onclick="ec.member.orderList.exchangeTip(this,'+o.orderCode+')">\u9000\u6362\u8d27</a></p>')}}}}else{if(o.orderStatus==7&&(o.timeDifference>=16||ec.member.orderList.GetDateDiff(o.updateDate)>=16)){r.push('<p class="p-link"><a href="javascript:;" onclick="ec.member.orderList.del(this,\''+o.orderCode+"');\">\u5220\u9664\u8ba2\u5355</a></p>")}else{if(c){if(o.type==35&&o.paymentStatus==1){}else{r.push('<p class="p-link"><a href="javascript:;" data-href="/member/exchange/get-'+o.orderCode+'" onclick="ec.member.orderList.exchangeTip(this,'+o.orderCode+')">\u9000\u6362\u8d27</a></p>')}}}}r.push('<p class="p-link"><a href="/member/order-'+o.orderCode+"?isHisData="+C+'">\u8ba2\u5355\u8be6\u60c5</a></p>');if(o.isRefund==1){r.push('<p class="p-link"><a href="/member/refund?ordercode='+o.orderCode+"&isLive="+C+'">\u9000\u6b3e\u8be6\u60c5</a></p>')}r.push("</td>")}}r.push("</tr>");var h=false;var w="";if(e.productCouponList!=undefined&&e.productCouponList.length>0){for(var q=0;q<e.productCouponList.length;q++){w+='<tr class="o-gift">';w+='<td class="col-gift" colspan="2">';w+='<p class="d-name"><b>\u8d60\u54c1</b>'+e.productCouponList[q].couponName+"</p>";w+="</td>";w+='<td class="col-price">--</td>';w+='<td class="col-quty">'+e.productCouponList[q].quantity+"</td>";w+="</tr>"}}var F=0;if(e.subOrderProductInfoList!=undefined&&e.subOrderProductInfoList.length>0){for(var x=0;x<e.subOrderProductInfoList.length;x++){var v=e.subOrderProductInfoList[x];if(F==0&&(v.itemType=="B"||v.productTypeInfo=="P")){r.push(w);h==true;F++}r.push('<tr><td class="col-pro-img"><p class="p-img">');r.push('<a title="'+v.skuName+'" href="/product/'+v.productId+".html#"+v.skuId+'" target="_blank" onclick="pushProMsg('+v.skuId+",'300130101')\">");if(v.photoPath){r.push('<img class="nocomment-'+v.skuCode+'" alt="'+v.skuName+'" src="'+ec.mediaPath+v.photoPath+"100_100_"+ec.encodeForHTML(v.photoName)+'"/>')}else{r.push('<img class="nocomment-'+v.skuCode+'" alt="" src=""/>')}r.push("</a></p>");r.push("</td>");r.push('<td class="col-pro-info"><p class="p-name">');if(v.itemType=="B"||v.productTypeInfo=="P"){r.push("<b>\u5957\u9910\u5546\u54c1</b>")}if(v.itemType=="G"){r.push("<b>\u914d</b>")}r.push('<a title="'+v.skuName+'" target="_blank" ');r.push('class="nocomment-'+v.skuCode+'"href="/product/'+v.productId+".html#"+v.skuId+'" onclick="pushProMsg('+v.skuId+",'300130101')\">"+v.skuName+"</a>");r.push('</p></td><td class="col-price">');if(o.type==18&&v.productType==4&&o.balanceAmount==null){r.push("<span>");r.push("\u6682\u65e0\u62a5\u4ef7")}else{r.push("<em>&yen;</em><span>");r.push((v.unitPrice||0).toFixed(2))}r.push('</span></td><td class="col-quty">');r.push(v.quantity+"</td>");r.push("</tr>")}}if(!h&&F==0&&e.productCouponList!=null&&e.productCouponList.length>0){for(var m=0;m<e.productCouponList.length;m++){r.push('<tr class="o-gift">');r.push('<td class="col-gift" colspan="2">');r.push('<p class="d-name"><b>\u8d60\u54c1</b>'+e.productCouponList[m].couponName+"</p>");r.push("</td>");r.push('<td class="col-price">--</td>');r.push('<td class="col-quty">'+e.productCouponList[m].quantity+"</td>");r.push("</tr>")}F++}if(o.couponList!=null&&o.couponList.length>0&&B==f.length-1){for(var z=0;z<o.couponList.length;z++){r.push('<tr class="o-gift">');r.push('<td class="col-gift" colspan="2">');r.push('<p class="d-name"><b>\u8d60\u54c1</b>'+o.couponList[z].couponName+"</p>");r.push("</td>");r.push('<td class="col-price">--</td>');r.push('<td class="col-quty">'+o.couponList[z].quantity+"</td>");r.push("</tr>")}}}return r.join("")};ec.member.orderList.skuList=function(c){var b=[];if(c!=null&&c.length>0){for(var a=0;a<c.length;a+=1){b.push("<em>"+c[a]+"</em>")}}return b.join("")};ec.member.orderList.depositList=function(a){var b=[];b.push('<div class="o-deposit">');b.push('<table border="0" cellpadding="0" cellspacing="0">');b.push('<tbody><tr><td class="col-deposit"><p class="d-name">\u9636\u6bb51\uff1a\u8ba2\u91d1</p></td>');b.push('<td class="col-price"><em>\u00a5</em><span>'+a.depositAmount.toFixed(2)+"</span></td>");b.push('<td class="col-quty">-</td>');if(a.paymentStatus==2){b.push('<td class="col-pay"><span>--</span></td>');b.push('<td class="col-operate">\u5f85\u652f\u4ed8</td>')}else{if(a.paymentStatus==3){if(a.paymentAmountTotal>=a.depositAmount){b.push('<td class="col-pay"><em>\u00a5</em><span>'+a.depositAmount.toFixed(2)+"</span></td>");b.push('<td class="col-operate">\u5df2\u652f\u4ed8</td>')}else{if(a.paymentAmountTotal<a.depositAmount&&a.paymentAmountTotal>0){b.push('<td class="col-pay"><em>\u00a5</em><span>'+a.paymentAmountTotal.toFixed(2)+"</span></td>");b.push('<td class="col-operate">\u90e8\u5206\u652f\u4ed8\u8ba2\u91d1</td>')}}}else{b.push('<td class="col-pay"><em>\u00a5</em><span>'+a.depositAmount.toFixed(2)+"</span></td>");b.push('<td class="col-operate">\u5df2\u652f\u4ed8</td>')}}b.push('</tr><tr class="disabled">');if(a.balanceStartTime!=""&&a.balanceStartTime!=null){b.push('<td class="col-deposit">\u9636\u6bb52\uff1a\u5c3e\u6b3e('+a.balanceStartTime+"\u81f3"+a.balanceEndTime+"\u652f\u4ed8)</td>")}else{b.push('<td class="col-deposit">\u9636\u6bb52\uff1a\u5c3e\u6b3e(\u6682\u65f6\u65e0\u6cd5\u83b7\u53d6\u5c3e\u6b3e\u652f\u4ed8\u65f6\u95f4\uff0c\u8bf7\u60a8\u7a0d\u540e\u518d\u8bd5\u8bd5)')}b.push('<td class="col-price">');if(null!=a.balanceAmount){b.push("<em>\u00a5</em><span>");b.push((a.balanceAmount).toFixed(2))}else{b.push("<span>");b.push("\u6682\u65e0\u62a5\u4ef7")}b.push("</span></td>");b.push('<td class="col-quty">-</td>');b.push('<td class="col-pay">');if(null!=a.balancePay){b.push("<em>\u00a5</em><span>");b.push(a.balancePay.toFixed(2))}else{b.push("<span>");b.push("--")}b.push("</span></td>");if(a.paymentStatus==1){b.push('<td class="col-operate">\u5df2\u652f\u4ed8</td>')}else{if(a.paymentStatus==2&&a.isBalancePayStart==0){b.push('<td class="col-operate">\u5f85\u652f\u4ed8</td>')}else{if(a.isBalancePayStart==0){if(a.paymentAmountTotal<=a.depositAmount){b.push('<td class="col-operate">\u5f85\u652f\u4ed8</td>')}else{if(a.paymentAmountTotal<a.cashPay&&a.paymentAmountTotal>a.depositAmount){b.push('<td class="col-operate">\u90e8\u5206\u652f\u4ed8\u5c3e\u6b3e</td>')}else{if(a.paymentAmountTotal==a.cashPay){b.push('<td class="col-operate">\u5df2\u652f\u4ed8</td>')}}}}else{if(a.isBalancePayStart==1){b.push('<td class="col-operate">\u652f\u4ed8\u65f6\u95f4\u672a\u5230</td>')}else{if(a.isBalancePayStart==4){b.push('<td class="col-operate"></td>')}else{if(a.isBalancePayStart==2){b.push('<td class="col-operate">\u652f\u4ed8\u671f\u5df2\u8fc7</td>')}}}}}}b.push("</tr></tbody></table></div>");return b.join("")};ec.member.orderList.exchangeTip=function(a){new ec.box($("#exchange-agreement").val(),{boxclass:"ol_box_4 ol_box_agreement",title:"\u9000\u6362\u8d27\u529e\u7406\u534f\u8bae",width:678,height:350,autoHeight:false,onok:function(){location.href=$(a).attr("data-href")}}).open()};ec.member.orderList.exchangeTip=function(b,a){$.ajax({type:"POST",url:"/member/exchange/getReturnExchangeFlag.json",data:{orderCode:a,isLive:$("#colid").val()},async:false,dataType:"json",success:function(c){if(null!=c&&c.success){var d=c.returnExchangeFlag;if(d==0){new ec.box($("#exchange-timeout").val(),{boxclass:"ol_box_4",autoHeight:false,showButton:false}).open()}else{if(d=="35210"){new ec.box($("#exchange-error").val(),{boxclass:"ol_box_4",autoHeight:false,showButton:false}).open()}else{new ec.box($("#exchange-agreement").val(),{boxclass:"ol_box_4 ol_box_title",title:"\u9000\u6362\u8d27\u529e\u7406\u534f\u8bae",width:700,autoHeight:false,onok:function(){location.href=$(b).attr("data-href")+"/"+d}}).open()}}}else{alert("\u83b7\u53d6\u8bf7\u6c42\u5931\u8d25");return false}}})};ec.member.orderList.del=function(c,a){var b='<span style="font-size:16px;">\u786e\u8ba4\u5220\u9664\u6b64\u8ba2\u5355?</span><br/><span style="font-size:14px;color:#333;">\u8ba2\u5355\u5220\u9664\u540e\u5c06\u65e0\u6cd5\u6062\u590d,\u8bf7\u8c28\u614e\u64cd\u4f5c!</span>';if(ec.ui.confirm(c,b)){new ec.ajax().get({url:"/member/order/del/"+a+".json",data:{isLive:$("#colid").val()},timeout:10000,timeoutFunction:function(){alert("\u8bfb\u53d6\u8d85\u65f6\uff0c\u8bf7\u91cd\u8bd5\uff01")},beforeSendFunction:function(){ec.ui.loading.show({modal:false})},afterSendFunction:function(){ec.ui.loading.hide()},successFunction:function(e){var f="";if(!e.success){var f="\u767b\u5f55\u5df2\u8d85\u65f6,\u8bf7\u91cd\u65b0\u767b\u5f55";var d=[];if(e.code!="login"){f=e.msg}d.push('<div class="box-prompt-error-area">');d.push('<div class="h"><i></i></div>');d.push('<div class="b"><span id="prompt-delorder" style="color:#3a3a3a;">'+f+"</span></div>");d.push("</div>");d.push('<div class="box-custom-button"><a class="box-ok box-button-style-1" href="javascript:;"><span>\u786e\u5b9a</span></a></div>');$("#msg-delorder-ok").html(d.join(""))}else{var d=[];d.push('<div class="box-right-1"><span id="prompt-delorder">\u6e29\u99a8\u63d0\u793a\uff1a\u8ba2\u5355\u5220\u9664\u6210\u529f</span></div>');d.push('<div class="box-button"><a class="box-ok box-button-style-1" href="javascript:;"><span>\u786e\u5b9a</span></a></div>');$("#msg-delorder-ok").html(d.join(""))}new ec.box($("#msg-delorder-ok").val(),{boxclass:"ol_box_4 small",boxid:"orderDelBox",title:"",modal:true,showButton:false,onok:function(g){if(e.code!="login"){window.location.href="/member/order?t="+new Date().getTime()}g.close()},onclose:function(g){if(e.code!="login"){window.location.href="/member/order?t="+new Date().getTime()}}}).open()}})}};var _del;ec.member.orderList.cancel=function(d,b,c){$("#cancelReson").val("");var a=$(d).attr("data-ordercode");_del=function(e){if(e){e.close()}new ec.ajax().get({url:"/member/cancelOrder-"+a+".json",data:{cancelReson:$("#cancelReson").val()},timeout:10000,timeoutFunction:function(){alert("\u8bfb\u53d6\u8d85\u65f6\uff0c\u8bf7\u91cd\u8bd5\uff01")},beforeSendFunction:function(){ec.ui.loading.show({modal:false})},errorFunction:function(f){ec.ui.loading.hide()},afterSendFunction:function(){ec.ui.loading.hide()},successFunction:function(i){if(!i.success){ec.showError(i);return}var h=[],k=i.order;var f=$(d).closest("td").html("<p class='p-link'><a href='/member/order-"+k.code+"' >\u8ba2\u5355\u8be6\u60c5</a></p>").closest(".list-group-item");var g=f.find(".o-info");var j="\u5df2\u53d6\u6d88";if(i.orderStatus==16){j="\u53d6\u6d88\u5904\u7406\u4e2d"}if(k.paymentStatus=="1"){j+="&nbsp;|&nbsp;\u5df2\u4ed8\u6b3e"}g.find(".col-state").html(j);h.push('<div class="col-info">');if(k.type!=18&&(k.paymentStatus==2||k.paymentStatus==3)&&(k.orderStatus==3||(k.orderStatus<3&&k.orderSource!=2))){h.push('<input type="checkbox" class="checkbox" name="payCheck" paymentStatus="'+k.paymentStatus+'"clearOrder="'+tempClearingTips+'" value="'+k.orderCode+'"/>')}h.push('<span class="o-date">');h.push(new Date(k.orderDate).format("yyyy-MM-dd HH:mm"));h.push('</span><span class="o-no">');h.push('\u8ba2\u5355\u53f7\uff1a<a href="/member/order-'+k.code+'" title="'+k.code+'">'+k.code+"</a></span>");if(k.type==33){h.push('<span class="o-icon-1">\u62fc\u8d2d</span>')}if(k.type==26){h.push('<span class="icon-priority"></span>')}h.push('</div><div class="col-state">'+j+"</div></div>");g.html(h.join(""));ec.member.orderList.orderCount();ec.member.orderList.box=new ec.box($("#cancel-msg-tpl").val(),{boxclass:"ol_box_4",title:"\u8ba2\u5355\u53d6\u6d88\u7533\u8bf7\u5df2\u63d0\u4ea4",showButton:false,onok:function(l){l.close()}}).open();return}})};ec.member.orderList.box=new ec.box($("#order-cancel").val(),{boxclass:"ol_box_4",title:"\u8ba2\u5355\u53d6\u6d88\u7533\u8bf7",boxid:"orderDelBox",width:700,modal:true,showButton:false,}).open();ec.member.orderList.orderCount()};ec.member.orderList.seltime=function(g,c){if($(g).parent("li").hasClass("current")){return}$("#colid").val(c);$("#checkid").val("all");$("#myOrder-cate li").removeClass("current");$("#myOrder-cate li:first").addClass("current");$(g).parent("li").addClass("current").siblings().removeClass("current");var a={pageNumber:1},d=$("#count-seltime-2").attr("data-num"),b=$("#count-seltime-3").attr("data-num"),f=$("#nocommentNum").attr("data-num"),e=$("#nocommentNum").attr("data-his");ec.member.orderList.load(a,c);if(c==0){$("#nocommentNum").parents("li").hide();$("#nocommentNum").text(e);if(e>0){$("#nocommentNum").show()}else{$("#nocommentNum").hide()}$("#count-seltime-2").text(0).closest("li").hide();$("#count-seltime-3").text(0).closest("li").hide()}else{$("#nocommentNum").parents("li").show();$("#count-seltime-2").text(d).closest("li").show();if(d>0){$("#count-seltime-2").show()}else{$("#count-seltime-2").hide()}$("#count-seltime-3").text(b).closest("li").show();if(b>0){$("#count-seltime-3").show()}else{$("#count-seltime-3").hide()}$("#nocommentNum").text(f);if(f>0){$("#nocommentNum").show()}else{$("#nocommentNum").hide()}}};ec.member.orderList.check=function(c,b){if($(c).parent("li").hasClass("current")){return}$("#checkid").val(b);$(c).parent("li").addClass("current").siblings().removeClass("current");var a={pageNumber:1};ec.member.orderList.load(a,b)};ec.member.orderList.renderPage=function(a){if(a.totalPage==1){$("#list-pager").hide();return}else{$("#list-pager").show()}$("#list-pager").pager({pageNumber:a.pageNumber,pageCount:a.totalPage,pageSize:5,text:{first:"|&lt;",pre:"&lt",next:"&gt;",last:"&gt;|"},item:["first","pre","qpage","next","last","quickPager"],callBack:ec.member.orderList.load})};ec.member.orderList.openLog=function(e,c){var b="/member/logisticslog.json",f=ec.member.orderList,d=$("#interface-dialog-"+c),a=$("#interface-msg-"+c);new ec.ajax().get({url:b,data:{orderCode:c,isHisData:$("#colid").val()},timeout:10000,timeoutFunction:function(){a.html('<div class="o-logistics-list-loading">\u8d85\u65f6\uff0c\u8bf7\u91cd\u8bd5\uff01</div>')},successFunction:function(g){if(!g.success){a.html('<div class="o-logistics-list-loading">\u8d85\u65f6\uff0c\u8bf7\u91cd\u8bd5\uff01</div>');return}if((null!=g.logisticsLogList)&&(g.logisticsLogList.length>0)){a.html(ec.member.orderList.interfaceTpl.parse("interface",g.logisticsLogList))}else{a.html('<div class="o-logistics-list-empty">\u6682\u65e0\u7269\u6d41\u4fe1\u606f</div>')}$(".o-logistics tbody tr:first").addClass("tr-latest")}})};ec.member.orderList.confirmDelivery=function(c,a,b){new ec.box($("#box-confirm").val(),{boxclass:"ol_box_4",width:600,title:"\u786e\u8ba4\u6536\u8d27\u6210\u529f",showButton:false,onok:function(d){new ec.ajax().get({url:"/member/confirmDelivery-"+a+".json",timeout:10000,timeoutFunction:function(){alert("\u8bfb\u53d6\u8d85\u65f6\uff0c\u8bf7\u91cd\u8bd5\uff01")},beforeSendFunction:function(){ec.ui.loading.show({modal:false})},afterSendFunction:function(){ec.ui.loading.hide()},successFunction:function(e){if(!e.success){alert("\u786e\u8ba4\u6536\u8d27\u5931\u8d25\uff01");return}$(c).hide();var f="/member/addUserRemarkView?orderCode="+a;d.setTitle("\u6e29\u99a8\u63d0\u793a");d.setContent($("#box-pj").val().replace("/member/prdRemarkView.html",f));d.setPosition()},errorFunction:function(){alert("\u786e\u8ba4\u6536\u8d27\u5931\u8d25\uff01")}})}}).open()};ec.member.orderList.tapcheckAll=function(){if($("#checkAllBox").attr("checked")){$("input[name='payCheck']").each(function(){this.checked=true});$("#bottomCheckAllBox").attr("checked",true)}else{$("input[name='payCheck']").each(function(){this.checked=false});$("#bottomCheckAllBox").attr("checked",false)}};ec.member.orderList.mergePay=function(){var e=$("#topButton").attr("class");if(e=="button-operate-merge-pay"){var c="";var a=document.getElementsByName("payCheck");var b=ec.member.orderList.checkPayCheck(a);if(!b){alert("\u8bf7\u9009\u62e9\u8981\u5408\u5e76\u4ed8\u6b3e\u7684\u8ba2\u5355")}else{for(var d=0;d<a.length;d++){if(a[d].checked){c+=a[d].value+"|"}}new ec.ajax().get({url:"/validate/orderClear.json",data:{orderList:c},timeout:10000,timeoutFunction:function(){},successFunction:function(f){if(f.success){$("#clearPay").attr({action:"/clearPay/order",method:"post"});$("#clear-Ips").val(JSON.stringify(f.ips));gid("clearPay").submit()}else{if(f.code=="login"){ec.account.loginName="";ec.account.afterLogin(function(){window.location.href=window.location.href})}else{if(f.payNoOne=="unPay"){$("#unPay-inOnce").val('<div class="box-errors-2" id="tipContent">\u60a8\u9009\u62e9\u7684\u8ba2\u5355\u7531\u4e0d\u540c\u5546\u5bb6\u53d1\u8d27\u5e76\u63d0\u4f9b\u552e\u540e\u670d\u52a1\uff0c\u6682\u4e0d\u652f\u6301\u5408\u5e76\u652f\u4ed8\uff0c\u8bf7\u5206\u522b\u8fdb\u884c\u652f\u4ed8\u3002</div><div class="box-button"><a href="javascript:;" class="box-sure" onclick="ec.member.orderList.boxCancle()"><span>\u786e\u8ba4</span></a></div>');ec.member.orderList.unpayTip()}else{$("#unPay-inOnce").val('<div class="box-errors-2" id="tipContent">\u975e\u5e38\u62b1\u6b49\uff0c\u8ba2\u5355\u6682\u65f6\u65e0\u6cd5\u652f\u4ed8\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\u6216\u8054\u7cfb\u5ba2\u670d\u3002</div><div class="box-button"><a href="javascript:;" class="box-sure" onclick="ec.member.orderList.boxCancle()"><span>\u786e\u8ba4</span></a></div>');ec.member.orderList.unpayTip()}}}}})}}};ec.member.orderList.checkPayCheck=function(c){var a=false;for(var b=0;b<c.length;b++){if(c[b].checked){a=true;break}}return a};ec.member.orderList.orderCount=function(){new ec.ajax().get({url:domainMain+"/member/orderCount.json?t="+new Date().getTime(),async:false,timeout:10000,successFunction:function(a){if(!a.success){return}var b=parseInt(a.orderCount.unpaidOrderCount+a.orderCount.partPaidOrderCount);if(b!=0){$("#count-seltime-2").show();$("#count-seltime-2").text(b);$("#count-seltime-2").attr("data-num",b)}else{$("#count-seltime-2").hide();$("#count-seltime-2").text(b);$("#count-seltime-2").attr("data-num",b)}$("#count-seltime-3").text(a.orderCount.unreceiptOrderCount?a.orderCount.unreceiptOrderCount:0);$("#count-seltime-3").attr("data-num",a.orderCount.unreceiptOrderCount?a.orderCount.unreceiptOrderCount:0)}})};ec.member.orderList.allOrderCount=function(){$.ajax({url:openApiDomain+"/rms/comment/getNoCommentPrdCount.json?t="+new Date().getTime(),type:"POST",dataType:"json",data:JSON.stringify({tab:"nocomment",dateType:"1"}),timeout:10000,beforeSend:function(a){a.withCredentials=true},success:function(a){var b=parseInt($("#count-seltime-2-wechat").html())+parseInt($("#count-seltime-3-wechat").html());if(b>0){$("#li-order-small span").html("\u5c0f\u7a0b\u5e8f\u8ba2\u5355<em>("+b+")</em>");ec.util.cookie.set("vmallOrderCountWechat",b)}else{$("#li-order-small span").html("\u5c0f\u7a0b\u5e8f\u8ba2\u5355");ec.util.cookie.set("vmallOrderCountWechat",0)}if(a.resultCode!=0){alert("\u5f88\u62b1\u6b49\uff01\u5f85\u8bc4\u4ef7\u67e5\u8be2\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u65b0\u64cd\u4f5c");return}var g,e,d,f;d=parseInt(a.data.count?a.data.count:0);f=0;if(d>0){$("#nocommentNum").text(d).show()}else{$("#nocommentNum").text(0).hide()}$("#nocommentNum").attr("data-num",d);$("#nocommentNum").attr("data-his",f);e=f;if(e>0){$("#count-seltime-1").text(e).show()}else{$("#count-seltime-1").text(0).hide()}g=parseInt(a.data.count?a.data.count:0)+parseInt($("#count-seltime-2").html())+parseInt($("#count-seltime-3").html());if(g>0){$("#count-seltime-0").text(g).show()}else{$("#count-seltime-0").text(0).hide()}var c=g+e;if(c>0){$("#li-order span").html("\u6211\u7684\u8ba2\u5355<em>("+c+")</em>");ec.util.cookie.set("vmallOrderCount",c)}else{$("#li-order span").html("\u6211\u7684\u8ba2\u5355");ec.util.cookie.set("vmallOrderCount",0)}$("#ec-tab").navMove({boxClass:"ec-tab-arrow"})}})};ec.member.orderList.urlStatus=function(){var a=window.location.href;if(a.search(/unpaid/)!=-1){$("#list-group").html("");var b=$("#myOrder-cate li").eq(1).find("a");ec.member.orderList.check(b,"unpaid")}else{if(a.search(/nocomment/)!=-1){$("#list-group").html("");var b=$("#myOrder-cate li").eq(2).find("a");ec.member.orderList.check(b,"nocomment")}else{if(a.search(/send/)!=-1){$("#list-group").html("");var b=$("#myOrder-cate li").eq(3).find("a");ec.member.orderList.check(b,"send")}}}};ec.member.orderList.payClick=function(){$("input[name='payCheck']").bind("click",function(){var a=0;$("input[name='payCheck']").each(function(b){if(this.checked){a++}});if(a==$("input[name='payCheck']").length&&$("input[name='payCheck']").length>1){$("#checkAllBox").attr("checked",true);$("#bottomCheckAllBox").attr("checked",true)}else{$("#checkAllBox").attr("checked",false);$("#bottomCheckAllBox").attr("checked",false)}})};ec.ready(function(){if(ec.isIE6){$(".o-logistics").hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")})}$("#ec-tab").navMove({boxClass:"ec-tab-arrow"});ec.member.orderList.urlStatus();$("#checkAllBox").click(function(){if(this.checked){$("input[name='payCheck']").each(function(a){this.checked=true});$("#bottomCheckAllBox").attr("checked",true)}else{$("input[name='payCheck']").each(function(){this.checked=false});$("#bottomCheckAllBox").attr("checked",false)}});$("#bottomCheckAllBox").click(function(){if(this.checked){$("input[name='payCheck']").each(function(){this.checked=true});$("#checkAllBox").attr("checked",true)}else{$("input[name='payCheck']").each(function(){this.checked=false})}});ec.member.orderList.allOrderCount();ec.member.orderList.GetDateDiff=function(a){var c=a;var b=new Date().getTime();var d=parseInt(Math.abs(c-b)/(1000*60*60*24));return d}});$(function(){$("#cancelOption li").live("click",function(){$(this).children("input").attr("checked","checked");$("#selectReson").html($("input[name='resonType']:checked")[0].nextSibling.nodeValue);$("#cancelReson").val($("input[name='resonType']:checked").val());$("#selectReson").addClass("click");$("#cancelErrorMessage").hide();$(".order-cancel").find(".order-cancel-pulldown").css({border:"1px solid #d6d6d6"})});$("#okButton").live("click",function(){if($("#cancelReson").val()==""){$("#cancelErrorMessage").show();$(".order-cancel").find(".order-cancel-pulldown").css({border:"1px solid #ca141d"});return}_del();ec.member.orderList.box.close()});$("#cancelButton").live("click",function(){ec.member.orderList.box.close()});if($("input[name='payCheck']").length==0||$("input[name='payCheck']").length==1){$("#myOrder-control-bottom").hide();$("#myOrder-control-bottom-up").hide()}$("input[name='payCheck']").bind("click",function(){var a=0;$("input[name='payCheck']").each(function(b){if(this.checked){a++}});if(a==$("input[name='payCheck']").length&&$("input[name='payCheck']").length>1){$("#checkAllBox").attr("checked",true);$("#bottomCheckAllBox").attr("checked",true)}else{$("#checkAllBox").attr("checked",false);$("#bottomCheckAllBox").attr("checked",false)}})});function pushProMsg(a,b){var c={UID:ec.util.cookie.get("uid"),TID:getPtid(),TIME:getTime(),CONTENT:{SKUID:a,click:"1"}};ec.account.dapPushMsg(b,c,"click");ec.code.addAnalytics({hicloud:true});_paq.push(["trackLink",b,"link",c])}ec.member.orderList.boxCancle=function(a){$("#ol_box").remove();$(".ol_box_mask").remove()};ec.member.orderList.remind=function(b,a,c,e,g){var f="";if(a==3){if(g==""||g=="undefined"||g=="null"){f="\u60a8\u7684\u8ba2\u5355\u6b63\u5728\u7b49\u5f85\u5546\u54c1\u51fa\u5e93\u3002\u50ac\u5355\u7533\u8bf7\u5df2\u6536\u5230\uff0c\u611f\u8c22\u60a8\u5bf9\u5546\u57ce\u7684\u652f\u6301\u3002"}else{f="\u60a8\u7684\u8ba2\u5355\u6b63\u5728\u7b49\u5f85\u5546\u54c1\u51fa\u5e93\uff0c\u9884\u8ba1\u53d1\u8d27\u65f6\u95f4\u4e3a"+g+"\u3002\u50ac\u5355\u7533\u8bf7\u5df2\u6536\u5230\uff0c\u611f\u8c22\u60a8\u5bf9\u5546\u57ce\u7684\u652f\u6301\u3002"}}else{if(a==5||a==9){f="\u60a8\u7684\u5546\u54c1\u6b63\u5728\u51fa\u5e93\u6253\u5305\u4e2d\uff0c\u5373\u5c06\u53d1\u8d27\u3002\u50ac\u5355\u7533\u8bf7\u5df2\u6536\u5230\uff0c\u611f\u8c22\u60a8\u5bf9\u5546\u57ce\u7684\u652f\u6301\u3002"}else{if(c!=""&&e!=""&&c!="undefined"&&e!="undefined"&&c!="null"&&e!="null"){f="\u60a8\u7684\u8ba2\u5355\u5df2\u7ecf\u4ea4\u7531"+c+"\u8fdb\u884c\u914d\u9001\uff0c\u8fd0\u5355\u53f7\u4e3a"+e+"\uff0c\u8bf7\u4fdd\u6301\u624b\u673a\u7545\u901a\uff0c\u7b49\u5f85\u914d\u9001\u5458\u4e0e\u60a8\u8054\u7cfb\u3002\u50ac\u5355\u7533\u8bf7\u5df2\u6536\u5230\uff0c\u611f\u8c22\u60a8\u5bf9\u5546\u57ce\u7684\u652f\u6301\u3002"}else{f="\u60a8\u7684\u8ba2\u5355\u5df2\u53d1\u8d27\uff0c\u8bf7\u4fdd\u6301\u624b\u673a\u7545\u901a\uff0c\u7b49\u5f85\u914d\u9001\u5458\u4e0e\u60a8\u8054\u7cfb\u3002\u50ac\u5355\u7533\u8bf7\u5df2\u6536\u5230\uff0c\u611f\u8c22\u60a8\u5bf9\u5546\u57ce\u7684\u652f\u6301\u3002"}}}var d='<div class="box-title-1">\u50ac\u5355\u7533\u8bf7\u5df2\u63d0\u4ea4</div><div class="hr-15"></div><div class="box-words">';d+="<p>"+f+"</p>";d+='</div> <div class="hr-20"></div><div class="box-button"><a href="javascript:;" class="box-ok"><span>\u786e\u5b9a</span></a></div>';ec.member.orderList.remindBox(d,b)};
