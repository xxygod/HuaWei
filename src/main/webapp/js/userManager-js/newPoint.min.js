ec.pkg("ec.member.newpoint");ec.load("ajax",{loadType:"lazy"});ec.load("jquery.movebar");ec.load("ec.pager");ec.member.newpoint.pageNumber=1;ec.member.newpoint.load=function(a){if(!ec.account.isLogin()){ec.account.afterLogin(function(){window.location.reload()});return}$.ajax({url:openApiDomain+"/point/queryPointHisDetail.json",data:{pageNum:a.pageNumber,pageSize:a.pageSize},dataType:"json",timeout:10000,beforeSend:function(b){b.withCredentials=true},success:function(f){if(f.resultCode!="200000"){return}f=f.data;if(f.rows&&f.rows.length>0){var c=[];for(var e=0;e<f.rows.length;e++){var h=f.rows[e];c.push('<div class="list-group-item">');c.push('<table border="0" cellpadding="0" cellspacing="0">');c.push("<tbody>");c.push("<tr>");var j="";if(h.createTime!=null){j=h.createTime.substring(0,10)}c.push('<td class="col-date">'+j+"</td>");var g="";if(h.sign=="+"){c.push('<td class="col-exp"><span>'+h.sign+"&nbsp;"+h.pointValue+"</span></td>")}else{if(h.sign=="-"){c.push('<td class="col-exp"><em>'+h.sign+"&nbsp;"+h.pointValue+"</em></td>")}}g=h.actionDesc;var d="";var b=0;if(h.actionType!="E"){if((h.skuCode!=null&&h.skuCode!="")||(h.orderCode!=null&&h.orderCode!="")){d+="\uff08"}if(h.skuCode!=null&&h.skuCode!=""){b=1;d+="\u5546\u54c1\u7f16\u7801\uff1a"+h.skuCode}if(h.orderCode!=null&&h.orderCode!=""){if(b==1){d+="\uff0c"}b=1;d+="\u8ba2\u5355\u7f16\u53f7\uff1a"+h.orderCode}if((h.skuCode!=null&&h.skuCode!="")||(h.orderCode!=null&&h.orderCode!="")){d+="\uff09"}}if(b==1){g+=d}c.push('<td class="col-soure">'+g+"</td>");c.push('<td class="col-way">');c.push("</tr>");c.push("</tbody>");c.push("</table>");c.push("</div>")}$("#list-group-empty").hide();$("#list-group").html(c.join(""));$("#list-group").show();a.totalPage=f.pageCount;ec.member.newpoint.renderPage(a);ec.ui.scrollTo("#list-group")}else{$("#list-group").html("<div class='list-group-empty'>\u60a8\u6682\u65f6\u6ca1\u6709\u76f8\u5173\u8bb0\u5f55\u3002</div>")}}})};ec.member.newpoint.renderPage=function(a){$("#list-pager").pager({pageNumber:a.pageNumber,pageCount:a.totalPage,pageSize:10,text:{first:"|&lt;",pre:"&lt",next:"&gt;",last:"&gt;|"},item:["first","pre","qpage","next","last","quickPager"],callBack:ec.member.newpoint.load})};ec.member.newpoint.tabClick=function(b,a){var c=$(b).closest("li");if(c.hasClass("current")){return}else{c.addClass("current");c.siblings().removeClass("current");ec.member.newpoint._showTabElement(c,a)}};ec.member.newpoint._showTabElement=function(e,a){var c=e.siblings().andSelf().size();for(var b=1;b<=c;b++){if(b==a){$("#tab-common-index-"+b).show()}else{$("#tab-common-index-"+b).hide()}}if(a==3){var d={pageNumber:1,pageSize:10};ec.member.newpoint.load(d)}};ec.member.newpoint._showRule=function(){var a=$("#ec-tab-grade ul").find("li:eq(2)");a.mouseenter();a.find("a").click()};ec.member.newpoint.showUserPointDetail=function(){$.ajax({url:openApiDomain+"/point/queryUserPointBalanceDetail.json",dataType:"json",data:{ifHisDetail:"0"},timeout:10000,beforeSend:function(a){a.withCredentials=true},success:function(b){if(b.resultCode!="200000"){return}b=b.data;var a="";$("#usablePoint").html(b.pointBlance);$("#usableCash").html(b.pointAmount);$("#expirePoint").html(b.lastExpirePointValue);if(b.lastExpireTime!=null){$("#expireTime").html("("+b.lastExpireTime+")")}if(b.status!=null&&b.status=="S"){$("#usablePoint").parent().parent().find("dt").append("\uff08\u5df2\u51bb\u7ed3\uff09");$("#usableCash").parent().parent().find("dt").append("\uff08\u5df2\u51bb\u7ed3\uff09")}}})};ec.ready(function(){$("#li-newpoint").addClass("current");$("#pathTitle").html("\u6211\u7684\u79ef\u5206");$("#concern-list :checkbox").click(function(){if(!this.checked){$("#checkAll-top,#checkAll-buttom").attr("checked",false)}});$("#ec-tab-grade").navMove({boxClass:"ec-tab-arrow"});var b=$("#ec-tab-grade").find(".current");var a=b.index()+1;ec.member.newpoint._showTabElement(b,a);ec.member.newpoint.showUserPointDetail()});
